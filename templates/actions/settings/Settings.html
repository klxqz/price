{$settings = $plugin->getSettings()}
<ul class="plugin-menu">
    <li><a href="http://support.wa-plugins.ru/" target="_blank"><i class="icon16 ss pt hammer"></i>Поддержка разработчика плагина</a></li>
</ul>

<script src="{$wa_url}wa-content/js/jquery-ui/jquery.ui.sortable.min.js"></script>
<style type="text/css">
    .plugin-menu{
        float: right;
        list-style: none;
    }

    .plugin-menu li{
        float: left;
        margin-left: 10px;
    }

    div.geshifilter {
        background-color: #f8f8f8;
        border: 1px solid #ccc;
        color: #222;
        display: block;
        line-height: 1.3;
        margin: 0.5em;
        overflow: auto;
        padding: 0.5em;
    }
</style>
<h1>{$plugin->getName()}</h1>
<p>
    Плагин предоставляет возможность задать разные цены на одни и те же товары для отдельных групп покупателей и для отдельных поселений интернет-магазина.<br/>
    <a href="https://www.webasyst.ru/store/plugin/shop/price/" target="_blank">Подробнее</a> <i class="icon10 new-window"></i>
</p>




<div class="fields form">
    <form action="?module=plugins&id=price&action=save" method="post" id="plugins-settings-form">
        {$wa->csrf()}

        <div class="field-group">
            <div class="field">
                <div class="name">
                    Статус плагина
                </div>
                <div class="value no-shift s-ibutton-checkbox">
                    <input type="hidden" name="shop_price[status]" value="0">
                    <input type="checkbox" id="ibutton-status" name="shop_price[status]" value="1"{if $settings.status|default:0} checked{/if}>

                </div>
            </div>
        </div>
        <div class="field-group"{if !$settings.status|default:0} style="display:none"{/if}>
            <div class="field">
                <div class="name">
                    Выберите поселение
                </div>
                <div class="value">
                    <select name="route_hash" id="route-selector">
                        {foreach $route_hashs as $route_url => $route_hash}
                            <option value="{$route_hash}"{if $route_hash == $settings.route_hash|default:0} selected="selected"{/if}>{$route_url}</option>
                        {/foreach}
                    </select>
                </div>
            </div>
        </div>

        <div class="field-group"{if !$settings.status|default:0} style="display:none"{/if}>
            <div class="route-container block double-padded"></div>
        </div>

        <div class="field-group"{if !$settings.status|default:0} style="display:none"{/if}>
            <div class="field">
                <div class="value">
                    <p class="hint">
                        Нажмите «Добавить», чтобы создать новую категорию мультицен.<br/>
                        В поле «Цена» укажите название для создаваемой категории мультицены, например, «Оптовая цена» или «Дилерская цена».<br/>
                        Поле «Группа» определяет категорию покупателей, для которых данная мультицена будет применяться.                
                    </p>
                    <p class="hint">
                        «Сортировка приоритета» служит, чтобы задать приоритет выбора цен для покупателей, к которым применяются сразу несколько категорий мультицен.<br/>
                        Мультицена, которая находится выше другой, имеет более высокий приоритет.<br/>
                        Для изменения порядка следования мультицен перетаскивайте строки в таблице.
                    </p>

                    <p class="hint">
                        Внимание! Настройки мультицен привязаны к конкретному поселению, поэтому некоторые технические работы с поселениями или с доменами  могут сбить настройки плагина.<br/>
                        Например, если проводится настройка плагина на тестовом домене, а после настройки планируется перенос на рабочий домен с другим именем, то из-за разных доменных имен может произойти сбой в настройках плагина.
                    </p>
                </div>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript" src="{$wa_url}wa-content/js/jquery-plugins/jquery.tmpl.min.js"></script>
{literal}
    <script id="price-tmpl" type="text/x-jquery-tmpl">
        <tr data-id="${id}">
        <td class="align-center"><i class="icon16 sort"></i></td>
        <td>
        <input type="hidden" name="price[id]" value="${id}" />
        <input type="hidden" name="price[route_hash]" value="${route_hash}" />
        <input class="long" type="text" name="price[name]" value="${name}" />
        </td>
        <td>
        <select name="price[category_id]">
        {{each categories}}
        <option{{if (category_id == $value.id)}} selected{{/if}} value="${$value.id}">${$value.name}</option>
        {{/each}}
        </select>
        </td>
        <td class="align-center">
        <a class="inline save-row" href="#"><i class="icon16 yes"></i></a>
        <a class="inline delete-row" href="#"><i class="icon16 no"></i></a>
        </td>
        </tr>
    </script>
{/literal}


<script type="text/javascript" src="{$wa_app_static_url}plugins/price/js/price_settings.js?v{$plugin->getVersion()}"></script>
<script type="text/javascript">
    $.price_plugin.init({
        categories: {json_encode($categories)}
    });
</script>

